<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Darts Voice Prototype</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body class="theme-light">
  <header class="app-header">
    <h1>friendDartBoard</h1>
    <p class="tagline">Sprich deine Würfe - die App protokolliert das Leg.</p>
    <div class="main-menu-bar">
      <button
        type="button"
        class="main-menu-trigger"
        id="main-menu-trigger"
        aria-haspopup="true"
        aria-expanded="false"
        aria-controls="main-menu"
      >
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="sr-only">Hauptmenü öffnen</span>
      </button>
      <div id="main-menu" class="main-menu" aria-hidden="true">
        <div class="main-menu-section">
          <p class="main-menu-label">Ansicht</p>
          <div class="view-toggle" role="group" aria-label="Ansicht wählen">
            <button type="button" class="view-toggle-btn active" data-view="setup">Konfiguration</button>
            <button type="button" class="view-toggle-btn" data-view="play">Spielansicht</button>
            <button type="button" class="view-toggle-btn" data-view="training">Training</button>
            <button type="button" class="view-toggle-btn" data-view="camera">Kamera</button>
            <button type="button" class="view-toggle-btn" data-view="tournament">Turnier</button>
            <button type="button" class="view-toggle-btn" data-view="profiles">Profile</button>
            <button type="button" class="view-toggle-btn" data-view="leaderboard">Leaderboard</button>
          </div>
        </div>
        <div class="main-menu-section">
          <p class="main-menu-label">Layout</p>
          <div class="layout-toggle" role="group" aria-label="Layout wählen">
            <button type="button" class="layout-toggle-btn active" data-layout="auto">Auto</button>
            <button type="button" class="layout-toggle-btn" data-layout="desktop">Web</button>
            <button type="button" class="layout-toggle-btn" data-layout="mobile">Mobil</button>
          </div>
        </div>
        <div class="main-menu-section">
          <p class="main-menu-label">Farbschema</p>
          <button type="button" class="theme-toggle" id="theme-toggle" aria-pressed="false">
            <span class="theme-toggle-track" aria-hidden="true">
              <span class="theme-toggle-thumb"></span>
            </span>
            <span class="theme-toggle-text">
              <span class="theme-toggle-label">Dunkler Modus</span>
              <span class="theme-toggle-description">Aktuell: Hell</span>
            </span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main class="app-main">
    <section class="card setup-card" aria-labelledby="setup-title">
      <h2 id="setup-title">Spiel konfigurieren</h2>
      <form id="setup-form" class="setup-form">
        <div class="form-row">
          <label for="player-one-profile">Spieler 1 Profil</label>
          <select id="player-one-profile" name="playerOneProfile">
            <option value="">Benutzerdefiniert</option>
          </select>
        </div>
        <div class="form-row">
          <label for="player-one">Spieler 1 Name</label>
          <input id="player-one" name="playerOne" type="text" value="Player 1" autocomplete="off" required />
        </div>
        <div class="form-row">
          <label for="player-two-profile">Spieler 2 Profil</label>
          <select id="player-two-profile" name="playerTwoProfile">
            <option value="">Benutzerdefiniert</option>
          </select>
        </div>
        <div class="form-row">
          <label for="player-two">Spieler 2 Name</label>
          <input id="player-two" name="playerTwo" type="text" value="Player 2" autocomplete="off" required />
        </div>
        <p class="form-divider">Weitere Spieler (optional)</p>
        <div class="form-row optional">
          <label for="player-three-profile">Spieler 3 Profil</label>
          <select id="player-three-profile" name="playerThreeProfile">
            <option value="" selected>Benutzerdefiniert</option>
          </select>
        </div>
        <div class="form-row optional">
          <label for="player-three">Spieler 3 Name</label>
          <input
            id="player-three"
            name="playerThree"
            type="text"
            autocomplete="off"
            placeholder="Player 3"
          />
        </div>
        <div class="form-row optional">
          <label for="player-four-profile">Spieler 4 Profil</label>
          <select id="player-four-profile" name="playerFourProfile">
            <option value="" selected>Benutzerdefiniert</option>
          </select>
        </div>
        <div class="form-row optional">
          <label for="player-four">Spieler 4 Name</label>
          <input
            id="player-four"
            name="playerFour"
            type="text"
            autocomplete="off"
            placeholder="Player 4"
          />
        </div>
        <div class="form-row">
          <label for="starting-score">Startscore</label>
          <select id="starting-score" name="startingScore">
            <option value="501" selected>501</option>
            <option value="301">301</option>
          </select>
        </div>
        <div class="form-row">
          <label for="out-mode">Checkout-Regel</label>
          <select id="out-mode" name="outMode">
            <option value="single" selected>Single Out</option>
            <option value="double">Double Out</option>
          </select>
        </div>
        <div class="form-row">
          <label for="match-mode">Matchmodus</label>
          <select id="match-mode" name="matchMode">
            <option value="single" selected>Einzel-Leg</option>
            <option value="bestOfThreeLegs">Sätze (Best of 3 Legs, 2 Sätze zum Sieg)</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="submit" class="primary">Leg starten</button>
          <button type="button" id="reset-btn" class="ghost">Zurücksetzen</button>
        </div>
      </form>
    </section>

    <section class="card tournament-card" aria-labelledby="tournament-title">
      <h2 id="tournament-title">Turniermodus</h2>
      <p class="tournament-intro">
        Richte ein K.-o.-Turnier mit bis zu 16 Spielern aus. Die Gewinner jeder Runde steigen automatisch in das
        Viertel-, Halbfinale und Finale auf.
      </p>
      <form id="tournament-form" class="tournament-form">
        <div class="tournament-grid">
          <div class="form-row tournament-player-row">
            <label for="tournament-player-1">Spieler 1</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-1-profile" class="tournament-player-select" data-slot="1">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-1" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-2">Spieler 2</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-2-profile" class="tournament-player-select" data-slot="2">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-2" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-3">Spieler 3</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-3-profile" class="tournament-player-select" data-slot="3">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-3" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-4">Spieler 4</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-4-profile" class="tournament-player-select" data-slot="4">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-4" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-5">Spieler 5</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-5-profile" class="tournament-player-select" data-slot="5">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-5" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-6">Spieler 6</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-6-profile" class="tournament-player-select" data-slot="6">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-6" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-7">Spieler 7</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-7-profile" class="tournament-player-select" data-slot="7">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-7" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-8">Spieler 8</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-8-profile" class="tournament-player-select" data-slot="8">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-8" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-9">Spieler 9</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-9-profile" class="tournament-player-select" data-slot="9">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-9" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-10">Spieler 10</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-10-profile" class="tournament-player-select" data-slot="10">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-10" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-11">Spieler 11</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-11-profile" class="tournament-player-select" data-slot="11">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-11" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-12">Spieler 12</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-12-profile" class="tournament-player-select" data-slot="12">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-12" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-13">Spieler 13</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-13-profile" class="tournament-player-select" data-slot="13">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-13" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-14">Spieler 14</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-14-profile" class="tournament-player-select" data-slot="14">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-14" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-15">Spieler 15</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-15-profile" class="tournament-player-select" data-slot="15">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-15" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
          <div class="form-row tournament-player-row">
            <label for="tournament-player-16">Spieler 16</label>
            <div class="tournament-player-fields">
              <select id="tournament-player-16-profile" class="tournament-player-select" data-slot="16">
                <option value="">Benutzerdefiniert</option>
              </select>
              <input id="tournament-player-16" class="tournament-player-input" type="text" autocomplete="off" />
            </div>
          </div>
        </div>
        <div class="tournament-controls">
          <div class="form-row">
            <label for="tournament-match-mode">Matchmodus</label>
            <select id="tournament-match-mode" name="tournamentMatchMode">
              <option value="single" selected>Einzel-Leg</option>
              <option value="bestOfThreeLegs">Saetze (Best of 3 Legs, 2 Saetze zum Sieg)</option>
            </select>
          </div>
        </div>
        <div class="form-actions tournament-actions">
          <button type="submit" class="primary">Turnier starten</button>
          <button type="button" id="tournament-reset" class="ghost">Formular leeren</button>
        </div>
      </form>
      <div id="tournament-status" class="tournament-status" aria-live="polite"></div>
      <div class="tournament-bracket-wrapper">
        <h3>Turnierbaum</h3>
        <div id="tournament-bracket" class="tournament-bracket" aria-live="polite"></div>
      </div>
    </section>

    <section class="card scoreboard" aria-labelledby="scoreboard-title">
      <div class="scoreboard-header">
        <h2 id="scoreboard-title">Scoreboard</h2>
        <div class="scoreboard-actions">
          <button id="rematch-btn" type="button" class="scoreboard-rematch" hidden>Neues Leg</button>
          <button id="undo-btn" type="button" class="scoreboard-undo">Rückgängig</button>
        </div>
      </div>
      <p id="game-settings" class="game-meta" aria-live="polite"></p>
      <p id="active-player-banner" class="active-player-banner" aria-live="assertive"></p>
      <div id="scoreboard" class="scoreboard-grid" aria-live="polite"></div>
      <section class="scoreboard-quick" aria-labelledby="quick-select-title">
        <h3 id="quick-select-title">Schnellauswahl</h3>
        <div id="dart-picker" class="dart-picker" aria-label="Dart-Schnellauswahl für Single, Double, Triple und Bull">
          <div id="dart-number-grid" class="dart-grid dart-numbers" aria-label="Zahlenfelder"></div>
          <div id="dartboard-picker" class="dartboard-picker" hidden aria-label="Dartboard Darstellung"></div>
          <div class="dart-grid dart-bull">
            <button class="dart-button" data-label="SB" data-readable="Single Bull" data-score="25" data-multiplier="1"
              data-double="false">
              <span class="abbr">SB</span>
              <span class="value">25</span>
            </button>
            <button class="dart-button" data-label="DB" data-readable="Double Bull" data-score="50" data-multiplier="2"
              data-double="true">
              <span class="abbr">DB</span>
              <span class="value">50</span>
            </button>
            <button class="dart-button" data-label="0" data-readable="Nullwurf" data-score="0" data-multiplier="1"
              data-double="false">
              <span class="abbr">0</span>
              <span class="value">Miss</span>
            </button>
          </div>
        </div>
        <div class="dart-number-order" role="group" aria-label="Zahlenanordnung">
          <button type="button" class="dart-number-order-btn active" data-order="sequential">Zahlenfolge</button>
          <button type="button" class="dart-number-order-btn" data-order="adjacent">Nachbarn</button>
          <button type="button" class="dart-number-order-btn" data-order="dartboard">Dartboard</button>
        </div>
        <section class="card hot-board inline" aria-labelledby="hot-board-title">
          <div class="hot-board-header">
            <div>
              <h3 id="hot-board-title">Hot Number Board</h3>
              <p id="hot-number-meta">Sortiert nach aktuellen Treffern.</p>
            </div>
            <div class="hot-board-mode" role="group" aria-label="Hot-Number Quelle wählen">
              <button type="button" class="hot-board-mode-btn active" data-mode="live">Live</button>
              <button type="button" class="hot-board-mode-btn" data-mode="history">Historisch</button>
            </div>
          </div>
          <div id="hot-number-grid" class="hot-number-grid" aria-live="polite">
            <p class="hot-number-empty">Noch keine Würfe registriert.</p>
          </div>
        </section>
        <div class="dart-mode-switch" role="group" aria-label="Multiplikator wählen">
          <button type="button" class="dart-mode-button active" data-multiplier="1">Single</button>
          <button type="button" class="dart-mode-button" data-multiplier="2">Double</button>
          <button type="button" class="dart-mode-button" data-multiplier="3">Triple</button>
        </div>
        <div class="dart-combos" aria-label="Standardfolgen">
          <button type="button" class="combo-button" data-combo="1-20-5">1 • 20 • 5</button>
          <button type="button" class="combo-button" data-combo="3-19-7">3 • 19 • 7</button>
        </div>
      </section>
    </section>

    <div class="scoreboard-detail">
      <section id="scoreboard-heatmap" class="card scoreboard-heatmap" aria-live="polite" hidden>
        <p class="heatmap-empty">Heatmap wird angezeigt, sobald Wurfdaten vorliegen.</p>
      </section>
      <section class="card history" aria-labelledby="history-title">
        <h2 id="history-title">Verlauf</h2>
        <ul id="history-log" class="history-log"></ul>
      </section>
    </div>

    <section class="card voice-console" aria-labelledby="voice-title">
      <div class="voice-header">
        <h2 id="voice-title">Sprachsteuerung</h2>
        <span id="voice-status" class="status offline">Inaktiv</span>
      </div>
      <p class="voice-tip">
        Beispiele: „Triple 20“, „140“, „Double 16“, „Bust“, „Neuer Wurf“, „Rückgängig“.
      </p>
      <div class="voice-controls">
        <button id="listen-btn" class="primary" type="button">Aufnahme starten</button>
        <button id="stop-listen-btn" class="ghost" type="button">Aufnahme stoppen</button>
      </div>
      <div class="voice-readout" aria-live="assertive">
        <p><strong>Letzte Erkennung:</strong> <span id="last-utterance">–</span></p>
        <p><strong>Interpretation:</strong> <span id="last-interpretation">–</span></p>
      </div>
      <div class="fallback-manual">
        <h3>Fallback</h3>
        <div class="manual-row">
          <label for="manual-score">Score manueller Wurf</label>
          <input id="manual-score" type="number" min="0" max="180" step="1" />
          <div class="manual-actions">
            <div class="manual-actions-primary">
              <button id="manual-commit" type="button">Übernehmen</button>
              <button id="manual-bust" type="button" class="ghost">Bust</button>
            </div>
          </div>
        </div>
      </div>
      <div class="audio-controls">
        <button type="button" id="chase-audio-play-btn" class="ghost">
          Chase the Sun abspielen
        </button>
        <button type="button" id="anthem-play-btn" class="ghost">
          Gladbach-Hymne abspielen
        </button>
        <button type="button" id="darts-audio-play-btn" class="ghost">
          Darts 180 abspielen
        </button>
        <p class="audio-controls-hint">
          Chase the Sun startet automatisch bei W&uuml;rfen &gt; 60 Punkten, die Gladbach-Hymne bei W&uuml;rfen &gt; 100 und &lt; 180 Punkten und Darts 180 bei exakt 180 Punkten.
        </p>
      </div>
    </section>

    <section class="card camera-card" aria-labelledby="camera-title" hidden>
      <div class="camera-header">
        <div>
          <p class="camera-eyebrow">Computer Vision · Beta</p>
          <h2 id="camera-title">Kamera Modus</h2>
          <p class="camera-subtitle">
            Automatisches Scoring per Webcam – vom Videostream über Kalibrierung bis zum Score.
          </p>
        </div>
        <div class="camera-header-meta">
          <span id="camera-support-indicator" class="camera-support-indicator" role="status">
            Verfügbarkeit wird geprüft …
          </span>
          <button type="button" class="ghost" id="camera-help-toggle">Leitfaden</button>
        </div>
      </div>
      <div class="camera-grid">
        <div class="camera-preview-panel">
          <div class="camera-preview-wrapper">
            <video id="camera-video" playsinline autoplay muted></video>
            <canvas id="camera-overlay" width="1280" height="720" aria-hidden="true"></canvas>
            <div id="camera-preview-placeholder" class="camera-preview-placeholder">
              <p>Kein Videostream aktiv.</p>
              <p>Starte die Kamera, richte das Board aus und kalibriere den Mittelpunkt.</p>
            </div>
          </div>
          <div class="camera-preview-controls">
            <button type="button" class="primary" id="camera-connect-btn">Kamera öffnen</button>
            <button type="button" class="ghost" id="camera-stop-btn">Stoppen</button>
            <button type="button" class="ghost" id="camera-reference-btn">Referenzbild speichern</button>
            <button type="button" id="camera-calibration-btn">Kalibrierung starten</button>
            <button type="button" id="camera-detect-btn">Analyse nach Wurf</button>
            <button type="button" class="ghost" id="camera-simulate-btn">Treffer simulieren</button>
            <label class="camera-auto-commit">
              <input type="checkbox" id="camera-auto-commit" />
              <span>Treffer automatisch buchen</span>
            </label>
            <div class="camera-preview-advanced">
              <label class="camera-resolution-control">
                <span>Auflösung</span>
                <select id="camera-resolution-select">
                  <option value="1280x720">HD (1280×720)</option>
                  <option value="1920x1080" selected>Full HD (1920×1080)</option>
                  <option value="2560x1440">QHD (2560×1440)</option>
                  <option value="3840x2160">UHD (3840×2160)</option>
                </select>
              </label>
              <label class="camera-overlay-toggle">
                <input type="checkbox" id="camera-overlay-toggle" checked />
                <span id="camera-overlay-toggle-label">Overlay anzeigen</span>
              </label>
            </div>
          </div>
          <div class="camera-status-line">
            <p id="camera-status-text">Status: Inaktiv</p>
            <p id="camera-calibration-status" class="camera-calibration-status">Kalibrierung erforderlich</p>
          </div>
          <div class="camera-log" id="camera-log" aria-live="polite"></div>
        </div>
        <div class="camera-info-panel">
          <section class="camera-pipeline" aria-labelledby="camera-pipeline-title">
            <h3 id="camera-pipeline-title">OpenCV Pipeline</h3>
            <ol class="camera-pipeline-list" id="camera-pipeline-list">
              <li data-step="stream">
                <div>
                  <strong>Videostream holen</strong>
                  <p>getUserMedia → opencv.js Mat</p>
                </div>
                <span class="camera-step-status" data-status="pending">Ausstehend</span>
              </li>
              <li data-step="calibration">
                <div>
                  <strong>Board kalibrieren</strong>
                  <p>HoughCircles + Perspektivkorrektur</p>
                </div>
                <span class="camera-step-status" data-status="pending">Ausstehend</span>
              </li>
              <li data-step="detection">
                <div>
                  <strong>Darts erkennen</strong>
                  <p>Background Subtraction + Konturen</p>
                </div>
                <span class="camera-step-status" data-status="pending">Ausstehend</span>
              </li>
              <li data-step="conversion">
                <div>
                  <strong>(x, y) → Score</strong>
                  <p>Polarkoordinaten · Ring &amp; Sektor</p>
                </div>
                <span class="camera-step-status" data-status="pending">Ausstehend</span>
              </li>
              <li data-step="sync">
                <div>
                  <strong>Score buchen</strong>
                  <p>friendDartBoard Logik (501, Legs, Sets)</p>
                </div>
                <span class="camera-step-status" data-status="pending">Ausstehend</span>
              </li>
            </ol>
          </section>
          <section class="camera-calibration" aria-labelledby="camera-calibration-title">
            <h3 id="camera-calibration-title">Kalibrierung</h3>
            <p class="camera-calibration-hint">
              Klicke zuerst auf den Mittelpunkt, danach auf den äußeren Doppel-Rand. Werte lassen sich hier manuell feinjustieren.
            </p>
            <div class="camera-calibration-tools">
              <div class="camera-calibration-tool">
                <div class="camera-calibration-tool-header">
                  <span>Zoom</span>
                  <span id="camera-calibration-zoom-value">1.0&times;</span>
                </div>
                <div class="camera-zoom-controls">
                  <input
                    type="range"
                    min="1"
                    max="3"
                    step="0.1"
                    value="1"
                    id="camera-calibration-zoom"
                    aria-label="Kalibrierungs-Zoom einstellen"
                  />
                  <button type="button" class="ghost" id="camera-calibration-zoom-reset">Zurücksetzen</button>
                </div>
              </div>
              <div class="camera-calibration-tool">
                <div class="camera-calibration-tool-header">
                  <span>Feinjustierung</span>
                  <span class="camera-calibration-tool-hint">Mittelpunkt &amp; Radius in kleinen Schritten</span>
                </div>
                <div
                  id="camera-calibration-fine"
                  class="camera-calibration-fine"
                  role="group"
                  aria-label="Feinjustierungsbedienelemente"
                >
                  <div class="camera-calibration-dpad">
                    <button
                      type="button"
                      data-action="center"
                      data-axis="y"
                      data-direction="-1"
                      aria-label="Mittelpunkt nach oben verschieben"
                    >
                      Oben
                    </button>
                    <div class="camera-calibration-dpad-middle">
                      <button
                        type="button"
                        data-action="center"
                        data-axis="x"
                        data-direction="-1"
                        aria-label="Mittelpunkt nach links verschieben"
                      >
                        Links
                      </button>
                      <button
                        type="button"
                        data-action="center"
                        data-axis="x"
                        data-direction="1"
                        aria-label="Mittelpunkt nach rechts verschieben"
                      >
                        Rechts
                      </button>
                    </div>
                    <button
                      type="button"
                      data-action="center"
                      data-axis="y"
                      data-direction="1"
                      aria-label="Mittelpunkt nach unten verschieben"
                    >
                      Unten
                    </button>
                  </div>
                  <div class="camera-radius-fine">
                    <button type="button" data-action="radius" data-direction="-1">Radius -</button>
                    <span>Radius</span>
                    <button type="button" data-action="radius" data-direction="1">Radius +</button>
                  </div>
                </div>
              </div>
            </div>
            <form id="camera-calibration-form" class="camera-calibration-grid">
              <label>
                Center X
                <input type="number" step="0.01" min="0" max="1" id="camera-center-x" name="centerX" />
              </label>
              <label>
                Center Y
                <input type="number" step="0.01" min="0" max="1" id="camera-center-y" name="centerY" />
              </label>
              <label>
                Radius
                <input type="number" step="0.01" min="0.1" max="0.7" id="camera-radius" name="boardRadius" />
              </label>
              <label>
                Double innen
                <input type="number" step="0.01" min="0" max="1" id="camera-double-inner" name="doubleInner" />
              </label>
              <label>
                Triple außen
                <input type="number" step="0.01" min="0" max="1" id="camera-triple-outer" name="tripleOuter" />
              </label>
              <label>
                Triple innen
                <input type="number" step="0.01" min="0" max="1" id="camera-triple-inner" name="tripleInner" />
              </label>
              <label>
                Single Bull
                <input type="number" step="0.01" min="0" max="1" id="camera-single-bull" name="singleBull" />
              </label>
              <label>
                Double Bull
                <input type="number" step="0.01" min="0" max="1" id="camera-double-bull" name="doubleBull" />
              </label>
            </form>
          </section>
          <section class="camera-detections" aria-labelledby="camera-detections-title">
            <div class="camera-detections-header">
              <h3 id="camera-detections-title">Letzte Erkennungen</h3>
              <div class="camera-detections-actions">
                <button type="button" id="camera-clear-detections" class="ghost">Liste leeren</button>
              </div>
            </div>
            <ul id="camera-detection-list" class="camera-detection-list" aria-live="polite">
              <li class="camera-detection-empty">Noch keine Treffer analysiert.</li>
            </ul>
          </section>
          <section class="camera-instructions" aria-labelledby="camera-instructions-title">
            <h3 id="camera-instructions-title">Leitfaden</h3>
            <ul>
              <li>Videostream holen: Browser <code>getUserMedia</code>, Übergabe an <code>opencv.js</code>.</li>
              <li>Board erkennen: <code>HoughCircles</code>, <code>Canny</code> &amp; <code>HoughLines</code>, danach Homography.</li>
              <li>Darts erkennen: Vorher/Nachher Bild differenzieren, Konturen filtern, Spitze lokalisieren.</li>
              <li>Score berechnen: Koordinaten normalisieren, Radius &amp; Winkel → Ring + 20er-Sektor.</li>
              <li>Score verbuchen: Treffer werden direkt an die bestehende 501/Leg/Set-Logik übergeben.</li>
            </ul>
          </section>
        </div>
      </div>
    </section>

    <section class="card training-card" aria-labelledby="training-title" hidden>
      <div class="training-card-header">
        <div>
          <h2 id="training-title">Training</h2>
          <p class="training-description" id="training-description">
            Around the Clock: Triff die Zahlen 1–20 der Reihe nach und beende mit Single-Bull.
          </p>
        </div>
        <span class="training-mode-pill" id="training-mode-label">Around the Clock</span>
      </div>

      <div class="training-mode-controls">
        <div class="training-mode-select">
          <label for="training-mode">Modus</label>
          <select id="training-mode">
            <option value="around" selected>Around the Clock</option>
            <option value="game121">121 Game</option>
          </select>
        </div>
        <div class="training-mode-select" id="training-variant-field">
          <label for="training-variant">Variante</label>
          <select id="training-variant">
            <option value="boardClockwise">Rundlauf linksrum (1 ➜ 20)</option>
            <option value="boardCounter">Rundlauf rechtsrum (20 ➜ 1)</option>
            <option value="numeric">Numerisch (1 ➜ 20)</option>
          </select>
        </div>
      </div>

      <div class="training-action-row">
        <button type="button" id="training-start" class="primary">Training starten</button>
        <button type="button" id="training-reset" class="ghost">Zurücksetzen</button>
      </div>

      <p class="training-status-message" id="training-status-message">
        Starte das Training, um deine Runde zu tracken.
      </p>

      <div class="training-players" id="training-players">
        <article class="training-player" data-training-slot="0">
          <header class="training-player-header">
            <h3 class="training-player-title" data-role="player-title">Spieler A</h3>
            <div class="training-player-config">
              <div class="form-row">
                <label for="training-player-1-profile">Profil</label>
                <select id="training-player-1-profile" class="training-player-profile">
                  <option value="">Benutzerdefiniert</option>
                </select>
              </div>
              <div class="form-row">
                <label for="training-player-1-name">Name</label>
                <input
                  id="training-player-1-name"
                  class="training-player-name"
                  type="text"
                  value="Spieler A"
                  autocomplete="off"
                />
              </div>
            </div>
          </header>

          <div class="training-player-board">
            <div class="training-target-panel">
              <p class="training-panel-label">Nächstes Ziel</p>
              <p class="training-target-value" data-role="target-label">-</p>
              <p class="training-target-meta" data-role="target-meta"></p>
              <div class="training-target-grid" data-role="target-grid"></div>
            </div>
            <div class="training-stats-panel">
              <div class="training-stat">
                <span class="training-stat-label training-progress-title" data-role="progress-title">Fortschritt</span>
                <span class="training-stat-value training-progress" data-role="progress-label">0 / 22</span>
              </div>
              <div class="training-stat">
                <span class="training-stat-label">Darts</span>
                <span class="training-stat-value" data-role="darts-label">0</span>
              </div>
              <div class="training-stat">
                <span class="training-stat-label">Zeit</span>
                <span class="training-stat-value" data-role="duration-label">00:00</span>
              </div>
            </div>
          </div>

          <div class="training-hit-controls">
            <button type="button" class="primary training-hit-btn" data-training-slot="0">Treffer</button>
            <button type="button" class="ghost training-miss-btn" data-training-slot="0">Fehlwurf</button>
          </div>

          <div class="training-player-history">
            <h4>Verlauf</h4>
            <ul class="training-history-list" data-role="history">
              <li class="training-history-empty">Noch keine Trainingseinheit gespeichert.</li>
            </ul>
          </div>
        </article>

        <article class="training-player" data-training-slot="1">
          <header class="training-player-header">
            <h3 class="training-player-title" data-role="player-title">Spieler B</h3>
            <div class="training-player-config">
              <div class="form-row">
                <label for="training-player-2-profile">Profil</label>
                <select id="training-player-2-profile" class="training-player-profile">
                  <option value="">Benutzerdefiniert</option>
                </select>
              </div>
              <div class="form-row">
                <label for="training-player-2-name">Name</label>
                <input
                  id="training-player-2-name"
                  class="training-player-name"
                  type="text"
                  value="Spieler B"
                  autocomplete="off"
                />
              </div>
            </div>
          </header>

          <div class="training-player-board">
            <div class="training-target-panel">
              <p class="training-panel-label">Nächstes Ziel</p>
              <p class="training-target-value" data-role="target-label">-</p>
              <p class="training-target-meta" data-role="target-meta"></p>
              <div class="training-target-grid" data-role="target-grid"></div>
            </div>
            <div class="training-stats-panel">
              <div class="training-stat">
                <span class="training-stat-label training-progress-title" data-role="progress-title">Fortschritt</span>
                <span class="training-stat-value training-progress" data-role="progress-label">0 / 22</span>
              </div>
              <div class="training-stat">
                <span class="training-stat-label">Darts</span>
                <span class="training-stat-value" data-role="darts-label">0</span>
              </div>
              <div class="training-stat">
                <span class="training-stat-label">Zeit</span>
                <span class="training-stat-value" data-role="duration-label">00:00</span>
              </div>
            </div>
          </div>

          <div class="training-hit-controls">
            <button type="button" class="primary training-hit-btn" data-training-slot="1">Treffer</button>
            <button type="button" class="ghost training-miss-btn" data-training-slot="1">Fehlwurf</button>
          </div>

          <div class="training-player-history">
            <h4>Verlauf</h4>
            <ul class="training-history-list" data-role="history">
              <li class="training-history-empty">Noch keine Trainingseinheit gespeichert.</li>
            </ul>
          </div>
        </article>
      </div>
    </section>

    <section class="card profile-manager" aria-labelledby="profile-title">
      <h2 id="profile-title">Spielerprofile</h2>
      <form id="profile-form" class="profile-form" data-mode="create">
        <div class="profile-form-grid">
          <div class="form-row">
            <label for="profile-first-name">Vorname</label>
            <input id="profile-first-name" name="firstName" type="text" autocomplete="off" required />
          </div>
          <div class="form-row">
            <label for="profile-last-name">Nachname</label>
            <input id="profile-last-name" name="lastName" type="text" autocomplete="off" required />
          </div>
          <div class="form-row">
            <label for="profile-nickname">Spitzname (Anzeige am Scoreboard)</label>
            <input id="profile-nickname" name="nickname" type="text" autocomplete="off" required />
          </div>
          <div class="form-row">
            <label for="profile-image">Profilbild</label>
            <input id="profile-image" name="image" type="file" accept="image/*" />
          </div>
        </div>
        <div class="profile-image-preview">
          <img id="profile-image-preview" alt="Profilbild Vorschau" hidden />
        </div>
        <input id="profile-id" name="profileId" type="hidden" />
        <div class="form-actions profile-actions">
          <button type="submit" id="profile-submit" class="primary">Profil speichern</button>
          <button type="reset" id="profile-reset" class="ghost">Zurücksetzen</button>
        </div>
      </form>
      <div class="profile-data-actions">
        <div class="profile-storage-switch" role="group" aria-label="Profilbasis waehlen">
          <label for="profile-storage-select">Profilbasis</label>
          <select id="profile-storage-select">
            <option value="azure">Azure Table</option>
            <option value="file">Lokale Datei</option>
          </select>
          <span id="profile-storage-indicator" class="profile-storage-indicator" aria-live="polite">
            Quelle: Azure Table
          </span>
        </div>
        <div class="profile-actions-inline" role="group" aria-label="Profil-Dateien verwalten">
          <button type="button" id="profile-export" class="ghost profile-icon-btn" title="Profile exportieren">
            <span aria-hidden="true">??</span>
            <span class="sr-only">Profile exportieren</span>
          </button>
          <button type="button" id="profile-import" class="ghost profile-icon-btn" title="Profile importieren">
            <span aria-hidden="true">??</span>
            <span class="sr-only">Profile importieren</span>
          </button>
        </div>
        <input id="profile-import-file" type="file" accept="application/json" hidden />
        <p id="profile-data-status" class="profile-data-status" role="status" aria-live="polite"></p>
      </div>      <div class="profile-list-container">
        <h3>Gespeicherte Profile</h3>
        <ul id="profile-list" class="profile-list"></ul>
      </div>
    </section>

    <section class="card leaderboard-card" aria-labelledby="leaderboard-title">
      <h2 id="leaderboard-title">Leaderboard</h2>
      <div class="leaderboard-controls" role="group" aria-label="Sortierung wählen">
        <button type="button" class="leaderboard-sort-btn active" data-sort="average">Ø Punkte/Dart</button>
        <button type="button" class="leaderboard-sort-btn" data-sort="legs">Legs gewonnen</button>
      </div>
      <div class="leaderboard-table-wrapper">
        <table class="leaderboard-table">
          <thead>
            <tr>
              <th scope="col">Platz</th>
              <th scope="col">Spieler</th>
              <th scope="col">Ø/Dart</th>
              <th scope="col">Ø 3-Dart</th>
              <th scope="col">Ø erste 12</th>
              <th scope="col">Checkout %</th>
              <th scope="col">Triple %</th>
              <th scope="col">Double %</th>
              <th scope="col">Sätze</th>
              <th scope="col">Legs</th>
              <th scope="col">Spiele</th>
            </tr>
          </thead>
          <tbody id="leaderboard-body"></tbody>
        </table>
        <p id="leaderboard-empty" class="leaderboard-empty" hidden>Keine Profile mit Statistiken vorhanden.</p>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <p>(❁´◡`❁) powered by penze</p>
  </footer>

  <template id="scoreboard-item-template">
    <article class="player-card">
      <header class="player-header">
        <div class="player-card-heatmap" aria-hidden="true"></div>
        <div class="player-header-content">
          <div class="player-identity">
            <div class="player-avatar-wrapper">
              <img class="player-avatar" alt="" hidden />
              <span class="player-avatar-fallback" aria-hidden="true">?</span>
            </div>
            <div class="player-name-wrapper">
              <h3 class="player-name"></h3>
              <p class="player-meta"></p>
            </div>
          </div>
          <span class="player-indicator" aria-hidden="true">?</span>
        </div>
      </header>
      <dl class="player-stats">
        <div class="player-sets-wrapper">
          <dt>Sätze</dt>
          <dd class="player-sets">0</dd>
        </div>
        <div class="player-legs-wrapper">
          <dt>Legs</dt>
          <dd class="player-legs">0</dd>
        </div>
        <div class="player-score-wrapper">
          <dt>Rest</dt>
          <dd class="player-score">501</dd>
        </div>
        <div class="player-average-wrapper">
          <dt>Ø 3-Dart</dt>
          <dd class="player-three-dart">0.00</dd>
        </div>
        <div class="player-last-wrapper">
          <dt>Letzter Wurf</dt>
          <dd class="player-last">-</dd>
        </div>
        <div class="player-checkout-wrapper" hidden>
          <dt>Checkout</dt>
          <dd class="player-checkout" data-state="none"></dd>
        </div>
      </dl>
    </article>
  </template>

  <audio id="chase-audio" src="data/chase-the-sun-win.mp3" preload="auto"></audio>
  <audio id="anthem-audio" src="data/hymne-gladbach.mp3" preload="auto"></audio>
  <audio id="darts-audio" src="data/darts-180.mp3" preload="auto"></audio>

  <script src="app.js" type="module"></script>
</body>

</html>

